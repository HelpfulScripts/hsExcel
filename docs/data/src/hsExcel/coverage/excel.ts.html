<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for excel.ts</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="prettify.css" />
    <link rel="stylesheet" href="base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="index.html">hsExcel: All files</a> excel.ts
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>63/63</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">95.12% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>39/41</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>12/12</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>54/54</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">20x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">6x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">10x</span>
<span class="cline-any cline-yes">10x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">8x</span>
<span class="cline-any cline-yes">7x</span>
<span class="cline-any cline-yes">7x</span>
<span class="cline-any cline-yes">7x</span>
<span class="cline-any cline-yes">7x</span>
<span class="cline-any cline-yes">36x</span>
<span class="cline-any cline-yes">36x</span>
<span class="cline-any cline-yes">180x</span>
<span class="cline-any cline-yes">36x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">36x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">11x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">31x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">7x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">55x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-yes">15x</span>
<span class="cline-any cline-yes">70x</span>
<span class="cline-any cline-yes">55x</span>
<span class="cline-any cline-yes">53x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-yes">2x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-yes">3x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">291x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">291x</span>
<span class="cline-any cline-yes">226x</span>
<span class="cline-any cline-yes">226x</span>
<span class="cline-any cline-yes">226x</span>
<span class="cline-any cline-yes">176x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">50x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">65x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">36x</span>
<span class="cline-any cline-yes">180x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">10x</span>
<span class="cline-any cline-yes">60x</span>
<span class="cline-any cline-yes">50x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">36x</span>
<span class="cline-any cline-yes">36x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">10x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">10x</span>
<span class="cline-any cline-yes">50x</span>
<span class="cline-any cline-yes">50x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">10x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * # Excel 
 * Convenience functions to access tables in Excel files.
 * Uses the {@link https://github.com/SheetJS/js-xlsx Sheet JS xlsx parser and writer}.
 * 
 */
&nbsp;
 /** */
const XLSX	= require('xlsx');
&nbsp;
import { DataRow}   from 'hsdatab';
import { WorkBook,
         WorkSheet,
         CellObject
       }            from 'xlsx/types';
&nbsp;
&nbsp;
/**
 * A structure describing an Excel table
 */
export interface TableStruct {
    names:string[];
    sheetName:string;
    headerRow:number;
    colIndex:string[]; 
}
&nbsp;
/**
 * 
 */
export interface Table {
    columns:TableStruct;
    table:DataRow[];
}
&nbsp;
export interface ExcelFile {
    getSheetNames:		() =&gt;string[];
    getTableColumns:	(sheetName:string, startCol?:string, row?:number) =&gt; TableStruct;
    getRowsForTable:	(table:TableStruct, maxRows?:number) =&gt; DataRow[];
    getTable:			(sheetID:string|number, startCol?:string, startRow?:number) =&gt; Table;
    nextExcelColIndex:	(startCol?:string) =&gt; IterableIterator&lt;string&gt;;
    getCellValue:		(sheet:string|WorkSheet, col:string, row:number) =&gt; string;		
}
&nbsp;
/**
 * reads and returns a promise for an {@link #/hsLog/hsNode.excelFile excel file}.
 * ```
 * {
 * 	  	{@link excel.File.getSheetNames getSheetNames},
 * 		{@link excel.File.getTableColumns getTableColumns},
 * 		{@link excel.File.getRowsForTable getRowsForTable},
 * 		{@link excel.File.getTable getTable},
 * 		{@link excel.File.nextExcelColIndex nextExcelColIndex},
 * 		{@link excel.File.getCellValue getCellValue}
 * }
 * ```
 * # Usage
 * ```
 * const excel = require('./hsNode.excel');
 * const excelFile = excel.excelFile('./aFile.xlsx');
 * ``` 
 * @param name the name of the Excel file to read
 * @returns an object of functions providing access to the contents of the excel file.
 */
export class File implements ExcelFile { 
	private workbook:WorkBook;
&nbsp;
    constructor(name:string, options?:any) {
        this.workbook = XLSX.readFile(name, options);
    }
&nbsp;
	/**
	 * retrieves sheet names from a file
	 * @returns {[string]} an array of sheet names
	 */
	public getSheetNames():string[] {
		const names:string[] = [];
		for (let s in this.workbook.Sheets) { 
			names.push(s);
		}
		return names;
	}
&nbsp;
	/**
	 * getTableColumns retrieves an array of consecutive valid column names.
	 * @param sheetName the sheet object to retrieve cells from
	 * @param startCol the first column of the table; defaults to 'A'.
	 * @param row the row to iterate over; defaults to 1.
	 * @returns an excel table description
	 */
	public getTableColumns(sheetName:string, startCol='A', row=1):TableStruct {
        const sheet:WorkSheet = this.workbook.Sheets[sheetName];
		return this.constructCol(sheetName, row, this.getConsecutiveColumnNames(sheet, row, startCol));
	}
	
	/**
	 * getRowsForTable returns a 2D array[r][c] of row values, where the columns match the provided 
	 * columns names. 
	 * @param table an array of column descriptors. 
	 * @param maxRows if specified, determines the maximum number of rows to scan for. 
	 * If omitted, iteration stops when the first row of empty values is encountered.
	 */
	public getRowsForTable(table:TableStruct, maxRows=0):DataRow[] {
		if (!table.sheetName) { throw new Error('illegal table parameter in getRowsForTable'); }
		const sheet:WorkSheet = this.workbook.Sheets[table.sheetName];
		const result:DataRow[] = [];
		let row=0; 
		while (true) {
			let newRow = this.getRow(sheet, row+table.headerRow+1, table.colIndex);
			let filledCells = 0;
			for (let c in newRow) { if (newRow[c]) { filledCells++; }}
            row++;
            // only return non-empty rows
            if (filledCells &gt; 0) { result.push(newRow); }
            // if no maxRows specified: break upon first empty row
            else if (maxRows&lt;=0) {  break; }
            // if rows exceed maxRows: break;
			if (maxRows&gt;0 &amp;&amp; row&gt;=maxRows) { break; }
		}
		return result;
	}
	
    /**
     * **generator** for Excel column indices starting at startCol. 
     * Following 'Z' the next column generated is 'AA' and so on. The generator 
     * starts with producing startCol as first index.
     * # Usage
     * ```
     * for (col of file.nextExcelColIndex(startCol='Y') { 
     *    printf("%s, ", col);      // -&gt; Y, Z, AA, AB
     *    if (col === 'AB')  { break; }
     * }
     * ```
     * @param startCol the first column index ('A', ....) to yield; defaults to 'A'
     */
    public* nextExcelColIndex(startCol='A'):IterableIterator&lt;string&gt; {
        function nextChar(c:string):string { return String.fromCharCode(c.charCodeAt(0) + 1); }
        
        let c = startCol;
        while (true) {
            yield c;
            if (c.length === 1) {
                c = (c &lt; 'Z')? nextChar(c[0]) : 'AA';
            } else {
                var ch = nextChar(c[1]);
                c = (ch &gt; 'Z')? nextChar(c[0])+'A' : c[0] + ch;
            }
        }
    }
&nbsp;
	/**
	 * gets a table of values, starting at the startCol and startRow.
	 * The table includes all consecutive columns with valid names, and all consecutive
	 * rows with at least one valid cell value.
	 * @param sheetID the sheet name or index from which to get the table
	 * @param startCol determines the left edge of the table; defaults to 'A'
	 * @param startRow determines the top edge of the table; defaults to 1
	 * @returns a tuple of {columns, table} 
	 */
	public getTable(sheetID:string|number, startCol='A', startRow=1) {
        const sheetName = (typeof sheetID === 'string')? sheetID : this.getSheetNames()[sheetID];
		const columns:TableStruct = this.getTableColumns(sheetName, startCol, startRow);
		const table:DataRow[]     = this.getRowsForTable(columns);
		return {columns, table};
    }
&nbsp;
    /**
	 * returns the value of a cell, or undefined
	 * @param sheet the sheet object or sheet name to retrieve cells from;
	 * @param col the column index ('A',...)
	 * @param row index (1,...)
	 * @returns the value of a cell, or undefined
	 */
	public getCellValue(sheet:string|WorkSheet, col:string, row:number):string {
		if (typeof sheet === 'string') { sheet = this.workbook.Sheets[sheet]; } 
        let c:CellObject;
		if (sheet[col+row] &amp;&amp; sheet[col+row].v!=='') { 
            c = sheet[col+row];
            let val = c.w!==undefined? c.w : <span class="branch-1 cbranch-no" title="branch not covered" >c.v;</span>
			<span class="missing-if-branch" title="else path not taken" >E</span>if (c) { switch(c.t) {
				case 's': return (&lt;string&gt;val).replace(/,/g,';').replace(/[\n\r]+/g,' ').trim();
				case 'n': /* falls through */ 
				default: return c.w.replace(/,/g,'');
			}}
		}
		return ''; 
	}
&nbsp;
    //----------- private methods ------------------
		
	/**
	 * **Generator**, yields consecutive cell values over a row
	 * @param sheet the sheet object or sheet name to retrieve cells from;
	 * @param row the row to iterate over
	 * @param colIterator iterable over columns;
	 * or an iterable that generates column indices.
	 */
	private* getCellValues(sheet:WorkSheet, row:number, colIterator:string[]) {
		for (let col of colIterator) {
			yield this.getCellValue(sheet, col, row); 
		}
	}
	
	/**
	 * **Generator**, yields consecutive column names as an 
	 * {col, name} object. 
	 * The generator exits when the first empty column name is encountered.
	 * @param sheet the sheet to scan
	 * @param row the row to scan
	 * @param startCol defaults to 'A'
	 */
	private* getConsecutiveColumnNames(sheet:WorkSheet, row:number, startCol:string) {
		for (let col of this.nextExcelColIndex(startCol)) {
			if (!this.getCellValue(sheet, col, row)) { break; }
			yield {col:col, name:this.getCellValue(sheet, col, row)}; 
		}
	}
&nbsp;
	/**
	 * returns an array[c] of values from columns that match indices provided `columns`.
	 * @param sheet the sheet object or sheet name to retrieve cells from;
	 * @param row the row to iterate over
	 * @param columns a) an array of column names. b) an {from:'A', to:'Z'} object 
	 * @return array of column values in the row
	 */
	private getRow(sheet:WorkSheet, row:number, columns:string[]) {
		const result = [...this.getCellValues(sheet, row, columns)];
		return result;
	}
&nbsp;
	/**
	 * returns the value of a cell, or undefined
	 * @param sheetName the sheet object or sheet name to retrieve cells from;
	 * @param row index (1,...)
     * @param it an iterator over columns
	 * @returns the value of a cell, or undefined
	 */
	private constructCol(sheetName:string, row:number, it:any):TableStruct {
		const result:TableStruct = {
			names:[],
			sheetName: sheetName,
			headerRow: row,
			colIndex:  &lt;string[]&gt;[]
		};
		for (let col of it) {
			result.names.push(col.name);
			result.colIndex.push(col.col);
		}
		return result;
	}
&nbsp;
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->

</div>
<script src="prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="sorter.js"></script>
</body>
</html>
